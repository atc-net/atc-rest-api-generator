namespace Atc.Rest.ApiGenerator.Helpers;

internal static class GenerateCodeHelper
{
    internal static void AppendGeneratedCodeWarningComment(
        StringBuilder sb,
        string apiGeneratorNameAndVersion)
    {
        sb.AppendLine("//------------------------------------------------------------------------------");
        sb.AppendLine($"// This code was auto-generated by {apiGeneratorNameAndVersion}.");
        sb.AppendLine("//");
        sb.AppendLine("// Changes to this file may cause incorrect behavior and will be lost if");
        sb.AppendLine("// the code is regenerated.");
        sb.AppendLine("//------------------------------------------------------------------------------");
    }

    internal static void AppendGeneratedCodeAttribute(
        StringBuilder sb,
        string apiGeneratorName,
        Version apiGeneratorVersion)
        => sb.AppendLine(4, $"[GeneratedCode(\"{apiGeneratorName}\", \"{apiGeneratorVersion}\")]");

    internal static string GetTrailingChar(
        TrailingCharType trailingChar)
        => trailingChar switch
        {
            TrailingCharType.None => string.Empty,
            TrailingCharType.Comma => ",",
            TrailingCharType.SemiColon => ";",
            TrailingCharType.Colon => ":",
            _ => throw new ArgumentOutOfRangeException(nameof(trailingChar), trailingChar, null),
        };
}