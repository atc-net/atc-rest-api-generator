using System;
using System.Text;
using Atc.Rest.ApiGenerator.Helpers.XunitTest;

namespace Atc.Rest.ApiGenerator.Helpers
{
    internal static class GenerateCodeHelper
    {
        internal static void AppendGeneratedCodeWarningComment(StringBuilder sb, string toolNameAndVersion)
        {
            sb.AppendLine("//------------------------------------------------------------------------------");
            sb.AppendLine($"// This code was auto-generated by {toolNameAndVersion}.");
            sb.AppendLine("//");
            sb.AppendLine("// Changes to this file may cause incorrect behavior and will be lost if");
            sb.AppendLine("// the code is regenerated.");
            sb.AppendLine("//------------------------------------------------------------------------------");
        }

        internal static void AppendGeneratedCodeAttribute(StringBuilder sb, string toolName, Version toolVersion)
        {
            sb.AppendLine(4, $"[GeneratedCode(\"{toolName}\", \"{toolVersion}\")]");
        }

        internal static string GetTrailingChar(TrailingCharType trailingChar)
        {
            return trailingChar switch
            {
                TrailingCharType.None => string.Empty,
                TrailingCharType.Comma => ",",
                TrailingCharType.SemiColon => ";",
                TrailingCharType.Colon => ":",
                _ => throw new ArgumentOutOfRangeException(nameof(trailingChar), trailingChar, null)
            };
        }
    }
}